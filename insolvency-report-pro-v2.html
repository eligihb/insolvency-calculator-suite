<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>×“×•"×— ××¡×›× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•×- ×—×™×™×‘/×ª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- ×œ×¡×§×¨×™×Ÿâ€“×©×•×˜ ×‘×“×•"×— ×¢×¦××• (×× ×ª×¨×¦×” ×œ×”×©×ª××© ××—×¨ ×›×š) -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      direction: rtl;
      text-align: right;
      margin: 0;
      background: #e5f6ff;
      font-size: 12px;
    }

    .top-bar {
      background: #0f766e;
      color: #fff;
      padding: 10px 18px;
      font-size: 18px;
      font-weight: 700;
      text-align: center;
    }

    .page {
      max-width: 1100px;
      margin: 12px auto;
      padding: 10px;
    }

    .card {
      background: #f8fafc;
      border-radius: 14px;
      border: 1px solid #dbeafe;
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.06);
      padding: 8px 10px;
      margin-bottom: 8px;
    }

    .section-title {
      font-size: 13px;
      font-weight: 700;
      color: #0f172a;
      text-align: center;
      margin: 0 0 4px;
      padding-bottom: 2px;
      border-bottom: 1px solid #e2e8f0;
    }

    .sub-title {
      font-size: 12px;
      font-weight: 600;
      color: #0f766e;
      margin: 4px 0 2px;
      text-align: right;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    label {
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 2px;
    }

    input[type="text"],
    input[type="number"],
    input[type="date"],
    input[type="month"],
    input[type="time"],
    textarea,
    select {
      font-size: 11px;
      padding: 3px 5px;
      border-radius: 8px;
      border: 1px solid #cbd5f5;
      background: #ffffff;
      min-width: 0;
      font-weight: 600; /* ×©×“×•×ª ××™×œ×•×™ ××•×“×’×©×™× ××¢×˜ */
    }

    textarea {
      resize: vertical;
    }

    .short   { width: 70px; }
    .tiny    { width: 50px; }
    .medium  { width: 120px; }
    .wide    { width: 220px; }
    .flex-1  { flex: 1 1 0; }

    .checkbox-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 4px;
      align-items: center;
    }

    .small-text {
      font-size: 11px;
      color: #64748b;
    }

    hr {
      border: none;
      border-top: 1px dashed #e2e8f0;
      margin: 4px 0;
    }

    .layout-main {
      display: grid;
      grid-template-columns: 1.1fr 1.9fr; /* ×©×××œ ×¦×¨ ×™×•×ª×¨, ×™××™×Ÿ ×¨×—×‘ */
      gap: 8px;
      align-items: stretch;
    }

    .red-label {
      color: #b91c1c;
      font-size: 11px;
      font-weight: 600;
    }

    .footer {
      text-align: center;
      font-size: 11px;
      color: #475569;
      margin-top: 6px;
    }

    .buttons-inline {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: flex-start;
      margin-bottom: 4px;
    }

    .btn {
      border: none;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 11px;
      cursor: pointer;
      font-weight: 600;
    }

    .btn-print   { background: #0ea5e9; color: #fff; }
    .btn-email   { background: #6366f1; color: #fff; }
    .btn-shot    { background: #0f766e; color: #fff; }
    .btn-reset   { background: #fef2f2; color: #b91c1c; border: 1px solid #fecaca; }

    /* ×”×›× ×¡×•×ª/×”×•×¦××•×ª ×‘×¦×‘×¢ */
    #familyIncomeTotal { color: #15803d; }
    #familyExpensesTotal { color: #b91c1c; }

    /* ×× ×”×—×™×™×‘/×ª ×œ× ×¢×•×‘×“/×ª â€“ ×§×˜×¢ ××•×“×’×© ×‘××“×•× */
    .not-working-section label,
    .not-working-section input,
    .not-working-section select {
      color: #b91c1c;
      border-color: #fecaca;
    }

    /* ×‘×œ×•×§ ××—×©×‘×•×Ÿ â€“ iframe */
    .calc-frame-card iframe {
      width: 100%;
      border: 0;
      border-radius: 12px;
      height: 540px; /* ××¤×©×¨ ×œ×›×•×•×Ÿ ×œ×¤×™ ×”×¦×•×¨×š */
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.1);
      background: #ffffff;
    }

    @media print {
      body { background: #ffffff; font-size: 11px; }
      .top-bar { border-bottom: 1px solid #cbd5e1; box-shadow: none; }
      .page { max-width: 100%; margin: 0; padding: 4mm; }
      .card { box-shadow: none; }
      .buttons-inline { display: none; }
    }
  </style>
</head>
<body>
  <div class="top-bar">
    ×“×•"×— ××¡×›× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•×- ×—×™×™×‘/×ª
  </div>

  <form id="reportForm">
    <div class="page">

      <!-- ×›×¨×˜×™×¡ ×¢×œ×™×•×Ÿ â€“ ×¤×¨×˜×™ ×ª×™×§ + ×¦×• ×ª×©×œ×•××™× + ××¦×‘ ×¨×¤×•××™ + ×›×¤×ª×•×¨×™× -->
      <div class="card">
        <div class="section-title">×¤×¨×˜×™ ×ª×™×§ ×•×¦×• ×ª×©×œ×•××™×</div>

        <!-- ×›×¤×ª×•×¨×™× ××©×××œ ×œ×—×¡×›×•×Ÿ ××§×•× ×‘×”×“×¤×¡×” -->
        <div class="buttons-inline">
          <button type="button" class="btn btn-print" onclick="window.print()">ğŸ–¨ ×”×“×¤×¡×” / PDF</button>
          <button type="button" class="btn btn-email" onclick="sendEmail()">âœ‰ ×©×œ×™×—×” ×‘××™×™×œ</button>
          <button type="button" class="btn btn-shot" onclick="screenshotReport()">ğŸ“¸ ×¦×™×œ×•× ××¡×š</button>
          <button type="button" class="btn btn-reset" onclick="document.getElementById('reportForm').reset()">â†º ××™×¤×•×¡</button>
        </div>

        <div class="row" style="justify-content: space-between; align-items:flex-start;">
          <!-- ×¦×“ ×™××™×Ÿ: ×¤×¨×˜×™ ×ª×™×§ -->
          <div style="flex: 1.1 1 0; min-width: 260px;">

            <div class="sub-title">×¤×¨×˜×™ ×ª×™×§</div>

            <div class="row">
              ×ª×™×§ ×××•× ×”:
              <input type="text" class="tiny" maxlength="5">
              ×ª×™×§ ×‘×™×”×"×©:
              <input type="text" class="medium" placeholder="123456-12-25">
            </div>

            <div class="row">
              ×©× ×”×—×™×™×‘/×ª:
              <input type="text" class="medium">
              ×©× ×”× ×××Ÿ:
              <input type="text" class="medium">
            </div>

            <div class="row">
              ×ª××¨×™×š ×¦×•:
              <input type="date" class="short">
              ×”×•×’×© ×œ×‘×§×©×ª:
              <label><input type="radio" name="order_by"> ×—×™×™×‘</label>
              <label><input type="radio" name="order_by"> × ×•×©×”</label>
            </div>

            <div class="row">
              ××§×•× ×©×™×¤×•×˜:
              <input type="text" class="short">
              ×ª××¨×™×š ×“×™×•×Ÿ:
              <input type="date" class="medium">
            </div>
            <div class="row">
              ×©×¢×ª ×“×™×•×Ÿ:
              <input type="time" class="short" step="300">
            </div>
          </div>

          <!-- ×××¦×¢: ××¦×‘ ×¨×¤×•××™ â€“ ××•×¢×‘×¨ ×œ×›××Ÿ -->
          <div style="flex: 0.9 1 0; min-width: 220px;">
            <div class="sub-title">××¦×‘ ×¨×¤×•××™ ×•××™×©×•×¨×™ ××œ"×œ</div>

            <div class="row">
              × ×›×•×ª:
              <input type="text" class="short percent-field" id="disabilityPercent" maxlength="3" placeholder="0%">
              ××™ ×›×•×©×¨:
              <input type="text" class="short percent-field" id="incapacityPercent" maxlength="3" placeholder="0%">
            </div>

            <div class="row">
              ×§×¦×‘××•×ª:
              <label><input type="checkbox"> ×§×¦×‘×ª ×™×œ×“</label>
              <label><input type="checkbox"> × ×›×”</label>
              <label><input type="checkbox"> ×”×‘×˜×—×ª ×”×›× ×¡×”</label>
              <label><input type="checkbox"> ×¡×™×•×¢ ×©×›"×“</label>
            </div>

            <div class="row">
              ×‘×¢×™×•×ª ×¨×¤×•××™×•×ª (×ª××¦×™×ª×™):
              <input type="text" class="flex-1">
            </div>
          </div>

          <!-- ×¦×“ ×©×××œ: ×¦×• ×ª×©×œ×•××™× -->
          <div style="flex: 1.2 1 0; min-width: 260px;">
            <div class="sub-title">×¦×• ×ª×©×œ×•××™×</div>
            <div class="row">
              ×ª×©×œ×•× ×—×•×“×©×™:
              <input type="text" class="short currency-input">
              ××™×•×:
              <input type="date" class="short">
            </div>
            <div class="row">
              ×ª×©×œ×•× ××“×•×¨×’:
              <input type="text" class="short currency-input" placeholder="×× ×™×©">
              ××™×•×:
              <input type="date" class="short">
            </div>
            <div class="row">
              ××¡×™×¨×” ×œ× ×•×©×™×:
              <label><input type="radio" name="notices"> ×›×Ÿ</label>
              <label><input type="radio" name="notices"> ×œ×</label>
            </div>
          </div>
        </div>
      </div>

      <!-- ×©×ª×™ ×¢××•×“×•×ª â€“ ×©×××œ: ×”×ª× ×”×œ×•×ª/×—×•×‘×•×ª/× ×›×¡×™×/×¡×™×›×•×, ×™××™×Ÿ: ×¤×¨×˜×™× ××™×©×™×™×/×”×›× ×¡×•×ª/××—×©×‘×•×Ÿ -->
      <div class="layout-main">

        <!-- ×¢××•×“×” ×©×××œ×™×ª -->
        <div>

          <!-- ×›×¨×˜×™×¡ ×”×ª× ×”×œ×•×ª, ×—×•×‘×•×ª ×•× ×›×¡×™× -->
          <div class="card">
            <div class="section-title">×”×ª× ×”×œ×•×ª ×”×—×™×™×‘, ×—×•×‘×•×ª ×•× ×›×¡×™×</div>

            <!-- ×”×ª× ×”×œ×•×ª ×”×—×™×™×‘ -->
            <div class="sub-title">×”×ª× ×”×œ×•×ª ×”×—×™×™×‘</div>

            <div class="small-text">×“×•"×—×•×ª ×—×•×“×©×™×™×:</div>
            <div class="checkbox-row">
              <label><input type="radio" name="reports_status"> ×”×•×’×©×•</label>
              <label><input type="radio" name="reports_status"> ×”×•×’×©×• ×—×œ×§×™×ª</label>
              <label><input type="radio" name="reports_status"> ×œ× ×”×•×’×©×• ×›×œ×œ</label>
            </div>

            <div class="row">
              ×”×¢×¨×•×ª ×“×•"×—×•×ª:
              <input type="text" class="flex-1">
            </div>

            <div class="sub-title" style="margin-top:4px;">××¡××›×™×</div>
            <div class="row">
              ××¡××›×™× ×—×¡×¨×™×:
              <label><input type="radio" name="missing_docs"> ×›×Ÿ</label>
              <label><input type="radio" name="missing_docs"> ×œ×</label>
            </div>

            <div class="sub-title" style="margin-top:4px;">×ª×©×œ×•××™×</div>
            <div class="row">
              ×¡×š ×¤×™×’×•×¨×™×:
              <input type="text" class="short currency-input">
            </div>

            <hr>

            <!-- ×—×•×‘×•×ª -->
            <div class="sub-title">×—×•×‘×•×ª</div>

            <div class="row" style="flex-wrap:nowrap;">
              ××¡' × ×•×©×™×:
              <input type="number" class="tiny" min="0" max="99" maxlength="2">
              ×¡×›×•× ×›×•×œ×œ:
              <input type="text" class="short currency-input">
              ×“×™×Ÿ ×§×“×™××”:
              <input type="text" class="short currency-input">
            </div>

            <div class="row">
              ×ª×‘×™×¢×•×ª ×—×•×‘ × ×‘×“×§×•:
              <label><input type="radio" name="claims_checked"> ×›×Ÿ</label>
              <label><input type="radio" name="claims_checked"> ×œ×</label>
            </div>

            <!-- ×—×•×‘×•×ª ×œ× ×‘×¨×™ ×”×¤×˜×¨ -->
            <div class="sub-title">×—×•×‘×•×ª ×œ× ×‘×¨×™ ×”×¤×˜×¨</div>
            <div class="row" style="flex-wrap:nowrap;">
              <label>
                <input type="checkbox" id="alimonyDebtChk">
                ××–×•× ×•×ª
              </label>
              ×¡×›×•×:
              <input type="number" id="alimonyDebtAmount" class="short" min="0" max="99999">
              <label>
                <input type="checkbox" id="taxDebtChk">
                ×¨×©×•×™×•×ª ×”××¡
              </label>
              ×¡×›×•×:
              <input type="number" id="taxDebtAmount" class="short" min="0" max="99999">
            </div>

            <hr>

            <!-- × ×›×¡×™× -->
            <div class="sub-title">× ×›×¡×™×</div>

            <div class="row">
              <label><input type="checkbox"> ×“×™×¨×ª ××’×•×¨×™×</label>
              <label><input type="checkbox"> × ×›×¡</label>
              <label><input type="checkbox"> ×¨×›×‘</label>
              <label><input type="checkbox"> ×–×›×•×™×•×ª</label>
            </div>

            <div class="row">
              ×”×¢×¨×›×ª ×©×•×•×™:
              <input type="text" class="medium currency-input">
            </div>
          </div>

          <!-- ×›×¨×˜×™×¡ ×¡×™×›×•× ×•×”××œ×¦×•×ª -->
          <div class="card">
            <div class="section-title">×¡×™×›×•× ×•×”××œ×¦×•×ª</div>

            <div class="sub-title">×¡×™×›×•× ×”× ×××Ÿ</div>
            <div class="row">
              <textarea rows="2" class="flex-1" placeholder="×ª××¦×™×ª ×¢××“×ª ×”× ×××Ÿ (×©×ª×™ ×©×•×¨×•×ª)"></textarea>
            </div>

            <div class="sub-title">×”××œ×¦×ª × ×××Ÿ</div>
            <div class="row" style="flex-wrap:nowrap;">
              <label><input type="checkbox"> ×”×›×©×¨×” ×›×œ×›×œ×™×ª</label>
            </div>
            <div class="row" style="flex-wrap:nowrap;">
              ×¡×›×•× ×—×•×“×©×™:
              <input type="text" class="short currency-input" maxlength="5">
              ××©×š (×—×•×“×©×™×):
              <input type="number" class="tiny" min="0" max="99">
              ×¡×›×•× ×›×•×œ×œ:
              <input type="text" class="short currency-input" maxlength="6">
            </div>

            <div class="sub-title">×¡×™×›×•× ×”×××•× ×”</div>
            <div class="row">
              <textarea rows="2" class="flex-1" placeholder="×ª××¦×™×ª ×¢××“×ª ×”×××•× ×” (×©×ª×™ ×©×•×¨×•×ª)"></textarea>
            </div>

            <div class="sub-title">×”××œ×¦×ª ×”×××•× ×”</div>
            <div class="row" style="flex-wrap:nowrap;">
              <label><input type="checkbox"> ×”×›×©×¨×” ×›×œ×›×œ×™×ª</label>
            </div>
            <div class="row" style="flex-wrap:nowrap;">
              ×¡×›×•× ×—×•×“×©×™:
              <input type="text" class="short currency-input" maxlength="5">
              ××©×š (×—×•×“×©×™×):
              <input type="number" class="tiny" min="0" max="99">
              ×¡×›×•× ×›×•×œ×œ:
              <input type="text" class="short currency-input" maxlength="6">
            </div>

            <div class="row">
              × ×™××•×§×™× ×œ×”××œ×¦×ª ×”×××•× ×”:
              <textarea rows="2" class="flex-1" placeholder="× ×™××•×§×™× ×§×¦×¨×™×"></textarea>
            </div>
          </div>

        </div>

        <!-- ×¢××•×“×” ×™×× ×™×ª -->
        <div class="card" style="display:flex;flex-direction:column;">
          <div class="section-title">×¤×¨×˜×™× ××™×©×™×™×, ×”×›× ×¡×•×ª ×•××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</div>

          <!-- ×¤×¨×˜×™× ××™×©×™×™× -->
          <div class="sub-title">×¤×¨×˜×™× ××™×©×™×™×</div>

          <div class="row" style="justify-content:flex-start; flex-wrap:wrap;">
            ××¦×‘ ××©×¤×—×ª×™:
            <label><input type="radio" name="family_status"> ×¨×•×•×§</label>
            <label><input type="radio" name="family_status"> × ×©×•×™</label>
            <label><input type="radio" name="family_status"> ×’×¨×•×©</label>
            <label><input type="radio" name="family_status"> ××œ××Ÿ</label>
            ×™×œ×“×™× ×§×˜×™× ×™×:
            <input type="number" class="tiny" min="0" max="99">
          </div>

          <div class="row">
            ×ª×©×œ×•× ××–×•× ×•×ª:
            <label><input type="radio" name="alimony"> ×›×Ÿ</label>
            <label><input type="radio" name="alimony"> ×œ×</label>
          </div>
          <div class="row">
            ×¡×›×•× ××–×•× ×•×ª:
            <input type="text" class="short currency-input">
          </div>

          <hr>

          <!-- ×”×›× ×¡×•×ª ×”×—×™×™×‘ -->
          <div class="sub-title">×”×›× ×¡×•×ª ×”×—×™×™×‘</div>

          <div class="row">
            ××§×¦×•×¢:
            <input type="text" class="short" placeholder="×œ××©×œ: ××™× ×¡×˜×œ×˜×•×¨">
            ××§×•× ×¢×‘×•×“×”:
            <input type="text" class="short">
          </div>
          <div class="row">
            ×”×™×§×£ ××©×¨×”:
            <input type="text" class="short" placeholder="××œ× / ×—×œ×§×™">
            ×ª×—×™×œ×ª ×¢×‘×•×“×”:
            <input type="month" class="medium">
          </div>

          <div class="row not-working-toggle-row" id="debtorIncomeRow">
            ×©×›×¨ × ×˜×•:
            <input type="text" class="short currency-input">
            <label><input type="checkbox" id="debtorNotWorking"> ×”×—×™×™×‘ ××™× ×• ×¢×•×‘×“</label>
          </div>

          <!-- ×¤×•×˜× ×¦×™××œ ×”×©×ª×›×¨×•×ª -->
          <div class="sub-title">×¤×•×˜× ×¦×™××œ ×”×©×ª×›×¨×•×ª</div>
          <div class="row" id="earningPotentialRow">
            ×¤×•×˜× ×¦×™××œ ×”×©×ª×›×¨×•×ª:
            <input type="text" id="earningPotential" class="short currency-input">
            ×”×¢×¨×•×ª:
            <input type="text" id="earningPotentialNotes" class="flex-1">
          </div>

          <hr>

          <!-- ×”×›× ×¡×•×ª ×‘×Ÿ/×‘×ª ×”×–×•×’ -->
          <div class="sub-title">×”×›× ×¡×•×ª ×‘×Ÿ/×‘×ª ×”×–×•×’</div>

          <div class="row">
            ××§×¦×•×¢:
            <input type="text" class="short">
            ××§×•× ×¢×‘×•×“×”:
            <input type="text" class="short">
          </div>
          <div class="row">
            ×”×™×§×£ ××©×¨×”:
            <input type="text" class="short" placeholder="××œ× / ×—×œ×§×™">
            ×ª×—×™×œ×ª ×¢×‘×•×“×”:
            <input type="month" class="medium">
          </div>
          <div class="row not-working-toggle-row" id="spouseIncomeRow">
            ×©×›×¨ × ×˜×•:
            <input type="text" class="short currency-input">
            <label><input type="checkbox" id="spouseNotWorking"> ×‘×Ÿ/×‘×ª ×”×–×•×’ ××™× ×•/×” ×¢×•×‘×“/×ª</label>
          </div>

          <hr>

          <!-- ×¡×š ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª -->
          <div class="sub-title">×¡×š ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª</div>

          <div class="row" style="flex-wrap:nowrap;">
            ×¡×š ×”×›× ×¡×•×ª ×œ×ª× ×”××©×¤×—×ª×™:
            <input type="text" id="familyIncomeTotal" class="short currency-input">
            ×¡×š ×”×•×¦××•×ª ×œ×ª× ×”××©×¤×—×ª×™:
            <input type="text" id="familyExpensesTotal" class="short currency-input">
          </div>

          <!-- ×‘×œ×•×§ × ×¤×¨×“ â€“ ××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× (iframe) -->
          <div class="calc-frame-card" style="margin-top:8px; flex:1 1 auto;">
            <div class="sub-title">××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</div>
            <!-- ×©×™× ×œ×‘: ×”×§×•×‘×¥ ×”××¦×•×™×Ÿ ×‘-src ×”×•× ×”×§×•×‘×¥ ×©×œ ×”××—×©×‘×•×Ÿ ×©×©×œ×—×ª -->
            <iframe src="payment-order-calculator.html" loading="lazy"></iframe>
          </div>
        </div>
      </div>

      <div class="footer">
        × ×‘× ×” ×¢×œ ×™×“×™ ××œ×™××‘ ×™×—×™××œ
      </div>
    </div>
  </form>

  <script>
    // ×¤×•×§×•×¡/×‘×œ×•×¨ ×œ××—×•×–×™× â€“ ×œ×”×¦×™×’ % ×‘×ª×•×š ×”×©×“×”, ×¢×“ 3 ×¡×¤×¨×•×ª
    function setupPercentField(id) {
      const el = document.getElementById(id);
      if (!el) return;
      el.addEventListener('focus', () => {
        el.value = el.value.replace('%','').trim();
      });
      el.addEventListener('blur', () => {
        let v = el.value.replace(/[^\d]/g,'');
        if (!v) { el.value = ''; return; }
        if (v.length > 3) v = v.slice(0,3);
        el.value = v + '%';
      });
    }

    setupPercentField('disabilityPercent');
    setupPercentField('incapacityPercent');

    // ×¢×™×¦×•×‘ ×¡×›×•××™ ×›×¡×£: 1,234 â‚ª ×‘×ª×•×š ×”×©×“×”
    function attachCurrencyFormatting() {
      const inputs = document.querySelectorAll(".currency-input");
      inputs.forEach(input => {
        input.addEventListener("focus", () => {
          const raw = input.value.replace(/[^\d.]/g, "");
          input.value = raw;
        });
        input.addEventListener("blur", () => {
          let v = input.value.replace(/[^\d.]/g, "");
          if (!v) {
            input.value = "";
            return;
          }
          const num = parseFloat(v.replace(/,/g, ""));
          if (!isNaN(num)) {
            input.value = num.toLocaleString("he-IL", {
              minimumFractionDigits: 0,
              maximumFractionDigits: 2
            }) + " â‚ª";
          }
        });
      });
    }

    function sendEmail() {
      const subject = encodeURIComponent('×“×•"×— ××¡×›× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•×- ×—×™×™×‘/×ª');
      const body = encodeURIComponent(
        '××¦×•×¨×£ ×“×•"×— ×¡×™×›×•× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•× ×›×œ×›×œ×™.\n\n' +
        '(×œ×™×¦×™×¨×ª PDF â€“ ×”×©×ª××©/×™ ×‘×›×¤×ª×•×¨ ×”×“×¤×¡×” ×•×©××•×¨/×™ ×›-PDF, ×•×œ××—×¨ ××›×Ÿ ×¦×¨×£/×™ ××ª ×”×§×•×‘×¥ ×œ××™×™×œ.)'
      );
      window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
    }

    // ×¦×™×œ×•× ××¡×š ×©×œ ×”×“×•"×— ×›×•×œ×•
    function screenshotReport() {
      const root = document.querySelector('.page');
      if (!root) return;
      html2canvas(root, {useCORS:true,allowTaint:true,scale:2,backgroundColor:'#ffffff'})
        .then(canvas => {
          const data = canvas.toDataURL('image/png');
          const w = window.open('','_blank');
          w.document.write('<img src="'+data+'" style="max-width:100%;display:block;margin:0 auto">');
          w.document.title = '×¦×™×œ×•× ×“×•"×— ×¡×™×›×•×';
        })
        .catch(() => alert('×©×’×™××” ×‘×™×¦×™×¨×ª ×¦×™×œ×•× ×”××¡×š'));
    }

    // ×”×—×™×™×‘/×‘×ª ×”×–×•×’ ××™× ×• ×¢×•×‘×“ â€“ ×œ×”×¤×•×š ×˜×§×¡×˜ ×œ××“×•×
    function setupNotWorkingToggle(checkboxId, rowId) {
      const chk = document.getElementById(checkboxId);
      const row = document.getElementById(rowId);
      if (!chk || !row) return;

      function update() {
        if (chk.checked) {
          row.classList.add('not-working-section');
        } else {
          row.classList.remove('not-working-section');
        }
      }
      chk.addEventListener('change', update);
      update();
    }

    document.addEventListener("DOMContentLoaded", () => {
      attachCurrencyFormatting();

      setupNotWorkingToggle('debtorNotWorking', 'debtorIncomeRow');
      setupNotWorkingToggle('spouseNotWorking', 'spouseIncomeRow');
    });
  </script>
</body>
</html>
